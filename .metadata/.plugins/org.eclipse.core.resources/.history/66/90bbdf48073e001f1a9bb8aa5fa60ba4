package com.mrlubert.prisoncontrol; 

import java.io.File;

import org.bukkit.command.CommandExecutor;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.event.Listener;
import org.bukkit.plugin.Plugin;
import org.bukkit.plugin.java.JavaPlugin;

import tech.mcprison.prison.Prison;
import tech.mcprison.prison.mines.PrisonMines;
import tech.mcprison.prison.ranks.PrisonRanks;


@SuppressWarnings("unused")
public class Main extends JavaPlugin 
{
	private CellCommand cellCmd;
	private UserBalanceUpdate balanceUpdate;
	Gamble2Utils gamble2Utils;
	private KappaKCommand kappaKCmd;
    public GambleUtils gambleUtils;
    private static PrisonPicks instance; 
    static File customYml;
    static FileConfiguration customConfig;
    PrisonMines prisonMines = Util.getPrisonMines(); 
    PrisonRanks prisonRanks = Util.getPrisonRanks(); 
    Prison prison = Util.getPrison();
    private NPCRightClick npcRClick;
    private NPCRightClick2 npcRClick2;
    
    @Override
    public void onLoad()
    {
        
        Config.setConfigFolder(this.getDataFolder().getAbsolutePath()); 
        Config.reloadConfigs(); 

        if (prisonMines != null)
        {
            try 
            {
                this.getLogger().info("Loading PrisonControl"); 
                
            }catch (Exception e)
            {
            	this.getLogger().info("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
            	this.getLogger().info("-=-=-=-=-=-=-=PrisonControl=-=-=-=-=-=-");
            	this.getLogger().severe("ERROR With Plugin!");
                this.getLogger().severe("Unable to load plugin! Are you running at least Prison, LuckPerms, Citizens, AreaShop, EssentialsX & AutoPickup?"); 
                this.getLogger().info("-=-=-=-=-=-=-=PrisonControl=-=-=-=-=-=-");
                this.getLogger().info("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
                e.printStackTrace(); 
                this.onDisable(); 
            }
        }
    }
    
    @Override
    public void onEnable()
    {
        instance = this; 
        this.cellCmd = new CellCommand(this);
        this.balanceUpdate = new UserBalanceUpdate(this);
        this.gamble2Utils = new Gamble2Utils(this);
        this.gambleUtils = new GambleUtils();
        this.kappaKCmd = new KappaKCommand(this);
        this.npcRClick = new NPCRightClick(this);
        this.getServer().getPluginManager().registerEvents(new Events(), this);
        this.getServer().getPluginManager().registerEvents((Listener)this.balanceUpdate, (Plugin)this);
        npcRClick = new NPCRightClick(this);
        this.getServer().getPluginManager().registerEvents((Listener)this.npcRClick, (Plugin)this);
        npcRClick2 = new NPCRightClick2(this);
        this.getServer().getPluginManager().registerEvents((Listener)this.npcRClick2, (Plugin)this);
        this.getCommand("pick").setExecutor(new PickCommands()); 
        getCommand("cell").setExecutor((CommandExecutor)this.cellCmd);
        getServer().getPluginManager().registerEvents((Listener)this.npcRClick, (Plugin)this);
        getCommand("kappak").setExecutor((CommandExecutor)this.kappaKCmd);
    }

    @Override
    public void onDisable()
    {
    }
    
    public static PrisonPicks getInstance()
    {
        return instance; 
    }
    
}