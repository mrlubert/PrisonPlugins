package com.mrlubert.prisonpicks; 

import java.io.File;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.plugin.java.JavaPlugin;

import com.sk89q.worldguard.WorldGuard;
import com.sk89q.worldguard.bukkit.WorldGuardPlugin; 

public class PrisonPicks extends JavaPlugin 
{

    private static PrisonPicks instance; 
    static File customYml;
    static FileConfiguration customConfig;
    String flagload = "";
    
    @Override
    public void onLoad()
    {
        
        Config.setConfigFolder(this.getDataFolder().getAbsolutePath()); 
        Config.reloadConfigs(); 
        
        WorldGuardPlugin worldGuard = Util.getWorldGuard(); 

        if (worldGuard != null)
        {
            try 
            {
                WorldGuard.getInstance().getFlagRegistry().register(Config.PRISON_PICK_FLAG);
                this.getLogger().info("prison-picks custom WorldGuard flag has been registered"); 
                flagload = "Loaded Custom Flag";
            }catch (Exception e)
            {
            	flagload = "ERROR Loading Custom Flag";
            	this.getLogger().info("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
            	this.getLogger().info("-=-=-=-=-=-=-=PrisonPicks=-=-=-=-=-=-");
            	this.getLogger().severe("[PrisonPicks] ERROR With WorldGuard Flag!");
                this.getLogger().severe("[PrisonPicks] Unable to register flag! Are you running at least WorldGuard 7+?"); 
                this.getLogger().info("-=-=-=-=-=-=-=PrisonPicks=-=-=-=-=-=-");
                this.getLogger().info("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
                e.printStackTrace(); 
                this.onDisable(); 
            }
        }
    }
    
    @Override
    public void onEnable()
    {
        instance = this; 
        this.getLogger().info(flagload);
        this.getLogger().info("Check Console For Errors.");
        this.getServer().getPluginManager().registerEvents(new Events(), this);
        this.getCommand("pick").setExecutor(new PickCommands()); 
    }

    @Override
    public void onDisable()
    {
    }
    
    public static PrisonPicks getInstance()
    {
        return instance; 
    }
    
}